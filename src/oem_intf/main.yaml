version: 1.0.0

# Project dependencies
dependencies: 
  - PyYAML
  - types-setuptools
#  - pysqlite3
  - types-paho-mqtt

# MQTT cfg
mqtt_cfg:
  broker_addr: broker.hivemq.com
  port: 1883
  client_id: foemv1
  username: mashraf
  password: Gttllee1332
  # Topic which oem will send data to vehicle
  pub_topic: foem/db_py_intf/v1_0_0/o2v
  # Topic which oem will receive data from vehicle
  sub_topic: foem/db_py_intf/v1_0_0/v2o
  # Topic for keeping alive
  ka_topic: foem/db_py_intf/v1_0_0/ka
  keep_alive: 60
  qos: 1
  encryption: False
  retain: True
  timeout: 10

# SQL cfg
sql_cfg:
  db_path: ""
  db_name: alpha_0_fota.db
  firmware_hash_type: SHA2-256
  ecu_schema: >
    CREATE TABLE IF NOT EXISTS ecu_data (
      id INTEGER NOT NULL PRIMARY KEY UNIQUE,
      manufacturer VARCHAR(100) NOT NULL,
      model VARCHAR(100) NOT NULL,
      software_version VARCHAR(50) NOT NULL,
      installation_date TEXT NOT NULL,
      last_update_date TEXT NOT NULL,
      vehicle_id INTEGER
    )

  firmware_schema: >
    CREATE TABLE IF NOT EXISTS firmware_data (
      id INTEGER NOT NULL PRIMARY KEY UNIQUE,
      version TEXT NOT NULL,
      firmware_in_hex TEXT NOT NULL,
      update_size INTEGER NOT NULL,
      update_hash TEXT NOT NULL UNIQUE,
      update_notes TEXT NOT NULL
    )

  vehicle_schema: >
    CREATE TABLE IF NOT EXISTS vehicle_data (
      id INTEGER NOT NULL PRIMARY KEY UNIQUE,
      vehicle_id TEXT NOT NULL UNIQUE,
      vehicle_name TEXT NOT NULL,
      vehicle_type TEXT NOT NULL,
      vehicle_status TEXT NOT NULL
    )

  fota_schema: >
    CREATE TABLE IF NOT EXISTS fota_data (
      id INTEGER NOT NULL PRIMARY KEY UNIQUE,
      vehicle_id INTEGER NOT NULL UNIQUE,
      firmware_id INTEGER NOT NULL UNIQUE,
      ecu_id TEXT NOT NULL,
      update_available INTEGER NOT NULL,
      update_status TEXT NOT NULL,
      last_update_time TEXT NOT NULL,
      update_success INTEGER NOT NULL,
      FOREIGN KEY (vehicle_id) REFERENCES vehicle_data(id),
      FOREIGN KEY (firmware_id) REFERENCES firmware_data(id),
      FOREIGN KEY (ecu_id) REFERENCES ecu_data(id)
    )

# CMD cfg
cmd_cfg:
  getters:
    - a
    - b
    - c
  setters:
    - x 
    - y
    - z
  requests:
    - k
    - o
    - p
